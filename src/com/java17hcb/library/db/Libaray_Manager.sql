-- MySQL Script generated by MySQL Workbench
-- Sat Apr 20 18:18:54 2019
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema Library_Manager
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `Library_Manager` ;

-- -----------------------------------------------------
-- Schema Library_Manager
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `Library_Manager` DEFAULT CHARACTER SET utf8 ;
USE `Library_Manager` ;

-- -----------------------------------------------------
-- Table `Library_Manager`.`STAFF`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`STAFF` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`STAFF` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `USERNAME` VARCHAR(45) NOT NULL,
  `PASSWORD` VARCHAR(150) NOT NULL,
  `FULLNAME` NVARCHAR(50) NOT NULL,
  `DATE_OF_BIRTH` DATETIME NOT NULL,
  `DIPLOMA` INT NOT NULL,
  `POSITION` INT NOT NULL,
  `DIVISION` INT NOT NULL,
  `ADDRESS` NVARCHAR(150) NOT NULL,
  `PHONE` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `USERNAME_UNIQUE` (`USERNAME` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`LIBRARY-CARD`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`LIBRARY-CARD` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`LIBRARY-CARD` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `CREATE_BY` INT NOT NULL,
  `FULLNAME` NVARCHAR(50) NOT NULL,
  `TYPE` INT NOT NULL,
  `DATE_OF_BIRTH` DATETIME NOT NULL,
  `ADDRESS` NVARCHAR(150) NOT NULL,
  `EMAIL` VARCHAR(45) NOT NULL,
  `CREATE_DATE` DATETIME NOT NULL,
  `EXPIRE_DATE` DATETIME NOT NULL,
  `FINES_FEE` DECIMAL NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_LIBRARY-CARD_STAFF_idx` (`CREATE_BY` ASC),
  CONSTRAINT `fk_LIBRARY-CARD_STAFF`
    FOREIGN KEY (`CREATE_BY`)
    REFERENCES `Library_Manager`.`STAFF` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`BOOK`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`BOOK` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`BOOK` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `NAME` NVARCHAR(50) NOT NULL,
  `TYPE` INT NOT NULL,
  `AUTHOR` NVARCHAR(50) NOT NULL,
  `PUBLISH_YEAR` YEAR NOT NULL,
  `PUBLISHER` NVARCHAR(150) NOT NULL,
  `PRICE` DECIMAL NOT NULL,
  `REMAIN_COPY` INT NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE INDEX `NAME_UNIQUE` (`NAME` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`BOOK_IMPORT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`BOOK_IMPORT` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`BOOK_IMPORT` (
  `BOOK_ID` INT NOT NULL,
  `IMPORT_BY` INT NOT NULL,
  `IMPORT_DATE` DATETIME NOT NULL,
  `COPY` INT NOT NULL,
  PRIMARY KEY (`BOOK_ID`, `IMPORT_BY`),
  INDEX `fk_BOOK_has_STAFF_STAFF1_idx` (`IMPORT_BY` ASC),
  INDEX `fk_BOOK_has_STAFF_BOOK1_idx` (`BOOK_ID` ASC),
  CONSTRAINT `fk_BOOK_has_STAFF_BOOK1`
    FOREIGN KEY (`BOOK_ID`)
    REFERENCES `Library_Manager`.`BOOK` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BOOK_has_STAFF_STAFF1`
    FOREIGN KEY (`IMPORT_BY`)
    REFERENCES `Library_Manager`.`STAFF` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`RENT-RECEIPT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`RENT-RECEIPT` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`RENT-RECEIPT` (
  `ID` INT NOT NULL AUTO_INCREMENT,
  `LIBRARY-CARD_ID` INT NOT NULL,
  `RENT_DATE` DATETIME NOT NULL,
  `STATUS` INT NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_RENT-RECEIPT_LIBRARY-CARD1_idx` (`LIBRARY-CARD_ID` ASC),
  CONSTRAINT `fk_RENT-RECEIPT_LIBRARY-CARD1`
    FOREIGN KEY (`LIBRARY-CARD_ID`)
    REFERENCES `Library_Manager`.`LIBRARY-CARD` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`BOOK_RENT-RECEIPT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`BOOK_RENT-RECEIPT` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`BOOK_RENT-RECEIPT` (
  `BOOK_ID` INT NOT NULL,
  `RENT-RECEIPT_ID` INT NOT NULL,
  `STATUS` INT ZEROFILL NOT NULL,
  PRIMARY KEY (`BOOK_ID`, `RENT-RECEIPT_ID`),
  INDEX `fk_BOOK_has_RENT-RECEIPT_RENT-RECEIPT1_idx` (`RENT-RECEIPT_ID` ASC),
  INDEX `fk_BOOK_has_RENT-RECEIPT_BOOK1_idx` (`BOOK_ID` ASC),
  CONSTRAINT `fk_BOOK_has_RENT-RECEIPT_BOOK1`
    FOREIGN KEY (`BOOK_ID`)
    REFERENCES `Library_Manager`.`BOOK` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BOOK_has_RENT-RECEIPT_RENT-RECEIPT1`
    FOREIGN KEY (`RENT-RECEIPT_ID`)
    REFERENCES `Library_Manager`.`RENT-RECEIPT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`RETURN-RECEIPT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`RETURN-RECEIPT` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`RETURN-RECEIPT` (
  `RENT-RECEIPT_ID` INT NOT NULL,
  `RETURN_DATE` DATETIME NOT NULL,
  `LATE_FEE` DECIMAL ZEROFILL NOT NULL,
  `TOTAL_FEE` DECIMAL ZEROFILL NOT NULL,
  PRIMARY KEY (`RENT-RECEIPT_ID`),
  CONSTRAINT `fk_RETURN-RECEIPT_RENT-RECEIPT1`
    FOREIGN KEY (`RENT-RECEIPT_ID`)
    REFERENCES `Library_Manager`.`RENT-RECEIPT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`FINES-RECEIPT`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`FINES-RECEIPT` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`FINES-RECEIPT` (
  `PAYED_BY` INT NOT NULL,
  `TAKED_BY` INT NOT NULL,
  `ID` INT NOT NULL AUTO_INCREMENT,
  `CURRENT_FINES_FEE` DECIMAL NOT NULL,
  `PAYMENT` DECIMAL NOT NULL,
  PRIMARY KEY (`PAYED_BY`, `TAKED_BY`),
  INDEX `fk_LIBRARY-CARD_has_STAFF_STAFF1_idx` (`TAKED_BY` ASC),
  INDEX `fk_LIBRARY-CARD_has_STAFF_LIBRARY-CARD1_idx` (`PAYED_BY` ASC),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  CONSTRAINT `fk_LIBRARY-CARD_has_STAFF_LIBRARY-CARD1`
    FOREIGN KEY (`PAYED_BY`)
    REFERENCES `Library_Manager`.`LIBRARY-CARD` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LIBRARY-CARD_has_STAFF_STAFF1`
    FOREIGN KEY (`TAKED_BY`)
    REFERENCES `Library_Manager`.`STAFF` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`LOST-HISTORY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`LOST-HISTORY` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`LOST-HISTORY` (
  `BOOK_ID` INT NOT NULL,
  `LIBRARY-CARD_ID` INT NOT NULL,
  `RECORD_BY` INT NOT NULL,
  `ID` INT NOT NULL AUTO_INCREMENT,
  `LOST_DATE` DATETIME NOT NULL,
  `FINES_FEE` DECIMAL ZEROFILL NOT NULL,
  PRIMARY KEY (`BOOK_ID`, `LIBRARY-CARD_ID`),
  INDEX `fk_BOOK_has_LIBRARY-CARD_LIBRARY-CARD1_idx` (`LIBRARY-CARD_ID` ASC),
  INDEX `fk_BOOK_has_LIBRARY-CARD_BOOK1_idx` (`BOOK_ID` ASC),
  INDEX `fk_LOST-HISTORY_STAFF1_idx` (`RECORD_BY` ASC),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  CONSTRAINT `fk_BOOK_has_LIBRARY-CARD_BOOK1`
    FOREIGN KEY (`BOOK_ID`)
    REFERENCES `Library_Manager`.`BOOK` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BOOK_has_LIBRARY-CARD_LIBRARY-CARD1`
    FOREIGN KEY (`LIBRARY-CARD_ID`)
    REFERENCES `Library_Manager`.`LIBRARY-CARD` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_LOST-HISTORY_STAFF1`
    FOREIGN KEY (`RECORD_BY`)
    REFERENCES `Library_Manager`.`STAFF` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `Library_Manager`.`LIQUIDATE-HISTORY`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Library_Manager`.`LIQUIDATE-HISTORY` ;

CREATE TABLE IF NOT EXISTS `Library_Manager`.`LIQUIDATE-HISTORY` (
  `BOOK_ID` INT NOT NULL,
  `LIQUIDATE_BY` INT NOT NULL,
  `ID` INT NOT NULL AUTO_INCREMENT,
  `LIQUIDATE_DATE` DATETIME NOT NULL,
  `REASON` NVARCHAR(150) NOT NULL,
  `COPY` INT NOT NULL,
  PRIMARY KEY (`BOOK_ID`, `LIQUIDATE_BY`),
  INDEX `fk_BOOK_has_STAFF_STAFF2_idx` (`LIQUIDATE_BY` ASC),
  INDEX `fk_BOOK_has_STAFF_BOOK2_idx` (`BOOK_ID` ASC),
  UNIQUE INDEX `ID_UNIQUE` (`ID` ASC),
  CONSTRAINT `fk_BOOK_has_STAFF_BOOK2`
    FOREIGN KEY (`BOOK_ID`)
    REFERENCES `Library_Manager`.`BOOK` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_BOOK_has_STAFF_STAFF2`
    FOREIGN KEY (`LIQUIDATE_BY`)
    REFERENCES `Library_Manager`.`STAFF` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
